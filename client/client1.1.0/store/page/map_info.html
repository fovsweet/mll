<link href="css/store_index.css" rel="stylesheet" />
<link rel="stylesheet" href="css/zTreeStyle.css" type="text/css">
<style type="text/css">
    #pro_store .data-content{width:376px;height:645px;padding:0px}
    #pro_store .data-content .page-header{margin-bottom:0px}
    #pro_store .data-content .page-header .close_log{position:absolute;top:15px;right:20px}
    #pro_store .pro_store_search{position:relative;width:100%;height:85px;text-align:center;background:#f5f5f5}
    #pro_store .pro_store_search .pro_icon{display:inline-block;position:absolute;width: 24px;height: 24px;top:30px;right:40px;background:url(images/search.png) no-repeat 50%;}
    #pro_store .pro_store_search input{width:316px;height:34px;margin:25px auto;background:#fff;-webkit-box-sizing:border-box;padding-left:10px}

    #pro_store .data-content .pro_ztree{padding:20px 30px;overflow:auto;height:370px;border:1px solid #ddd}
    
    .pro_sub{text-align:center;padding:20px 0}
    .pro_sub>button{width:148px;height:45px;margin:0px;border:1px solid #ddd;font-family: Arial,'微软雅黑';background:#ddd}
    .pro_sub button:hover{border:1px solid #ddd;color:#000}
    .pro_sub button:last-child{background: #2bc486;color:#fff;margin-left: 20px;margin-left:16px;border:1px solid #2bc486}
</style>
<!-- 内容-->
<div class='tab'>
    <div class="tab_menu">
        <ul>
            <li><a data-role='#map' href='javascript:;'>门店地图</a></li>
            <li class='act'><a data-role='#map_info' href='javascript:;'>门店详情</a></li>
        </ul>
    </div>
    <div id="map"></div>
    <div id="map_info">
        <div style='display:block'>
            <div class="info_header">
                <div>
                    <ul class='logo'>
                        <li style="background:#ddd">
                            <img src="">
                        </li>
                        <li>美乐乐旗舰店</li>
                        <li><i class="new_sotre" type="button" value="编辑" data-role='new_store'></i></li>
                    </ul>
                </div>
            </div>
            <div class="main_info list">
                <div class="top_left">
                    <ul>
                        <li><span class='required_info_name'>门店名称：</span><span>美乐乐旗舰店</span></li>
                        <li><span class='required_info_name'>门店类型：</span><span>美乐乐旗舰店</span></li>
                        <li><span class='required_info_name'>上级门店：</span><span>美乐乐旗舰店</span></li>
                        <li><span class='required_info_name'>门店状态：</span><span>美乐乐旗舰店</span></li>
                        <li><span class='required_info_name'>门店电话：</span><span>美乐乐旗舰店</span></li>
                        <li><span class='required_info_name'>联系人：</span><span>美乐乐旗舰店</span></li>
                        <li><span class='required_info_name'>经营范围：</span><span>美乐乐旗舰店</span></li>
                    </ul>
                </div>
                <div class="btm_right">
                    <ul>
                        <li><span class='required_info_name'>门店地址：</span><span style="vertical-align: top;width:auto;font-size:14px">四川省成都市青羊区光华东三路414号中铁西城地铁四号线中坝站</span></li>
                        <li><span class='required_info_name'>经纬度：</span><span style='font-size:14px'>12.265365,56.123456</span></li>
                        <li>
                            <div id='baiduMap'></div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- right_float-->
<div class="right_flex">
    <div class="flex_Click">
        <img src="images/ding.png">
    </div>
    <div class="flex_content zTreeDemoBackground">
        <div class='flex_title'>
            <button data-role='new_store'><span class='icon'></span>新增门店</button>
            <input type='text'/><a href='javascript:;' class='icon_search'></a>
        </div>
        <ul id="treeDemo" class="ztree"></ul>
    </div>
</div>
<!-- right_float-->
<!-- dialog -->
<div class="data-dia" id="new_store" style='overflow:auto'>
    <form style='width:100%'>
        <div class="data-content">
            <h2 class="page-header">
                新增门店
                <a class='close_log' href="javascript:;"></a>
            </h2>
            <div class="list" style="border-top:none;margin-top:0">
                <div class="top_left">
                    <ul>
                        <li><span class="required-field">*</span><span class='required_info_name'>门店名称：</span><input type="text" /></li>
                        <li><span class="required-field">*</span><span class='required_info_name'>门店类型：</span><input type="text" /></li>
                        <li><span class="required-field">*</span><span class='required_info_name'>上级门店：</span><input class='pro_store' data-role='pro_store' type="text" /></li>
                        <li><span class="required-field">*</span><span class='required_info_name'>门店状态：</span><input type="text" /></li>
                        <li><span class="required-field">*</span><span class='required_info_name'>门店电话：</span><input type="text" /></li>
                        <li><span class="required-field">*</span><span class='required_info_name'>联系人：</span><input type="text" /></li>
                    </ul>
                </div>
                <div class="btm_right">
                    <ul>
                        <li>
                            <span class="required-field">*</span>
                            <span style="margin-left:-5px" class='required_info_name'>门店名称：</span>
                            <select>
                                <option value="选项">选项</option>
                                <option value="选项">选项</option>
                            </select>
                            <select>
                                <option value="选项">选项</option>
                                <option value="选项">选项</option>
                            </select>
                        </li>
                        <li>
                            <span style='line-height:100px;height: 100px;float:left' class="required-field">*</span>
                            <span style='line-height:100px;margin-left:-20px;float:left' class='required_info_name'>门店logo：</span>
                            <a href="javascript:;" class="file" style="float:left">
                                选择文件
                                <input type="file" name="" id="" style="height:100%;cursor:pointer;background:#ddd">
                            </a>
                            <span style='line-height:100px;color:#999;float:left'>（建议尺寸：300*200）</span>
                        </li>
                        <li class="ssq">
                            <span class="required-field">*</span>
                            <span style="margin-left:-5px" class='required_info_name'>门店地址：</span>
                            <select>
                                <option value="请选择省">请选择省</option>
                                <option value="请选择省">广东</option>
                            </select>
                            <select>
                                <option value="请选择市">请选择市</option>
                                <option value="请选择市">深圳</option>
                            </select>
                            <select>
                                <option value="请选择区">请选择区</option>
                                <option value="请选择区">南山区</option>
                            </select>
                            <select>
                                <option value="请选择街道">请选择街道</option>
                            </select>
                            <input class='padding_left' type="text" placeholder='详细地址（无需写省、市、区、街道信息）' />
                            <span class='beizhu'>点击地图，标注准确位置！</span>
                        </li>
                        <li>
                            <span style="margin-left: 5px">地图标注：</span>
                            <div id='baiduMap_info' style="vertical-align: top"></div>
                        </li>
                        <li>
                            <span class='required_info_name' style="margin-left:-25px" >经纬度：</span>
                            <input type='text' readonly/>
                        </li>
                        <li class='sub'>
                            <input type='submit' value='取消'/>
                            <input type='submit' value='确认'/>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </form>
</div>
<div class='pro_store'>
    <div class="data-dia" id="pro_store" style='overflow:auto;display:none;z-index:1002;'>
        <div class="data-content">
            <h2 class="page-header">
                选择门店
                <a class="close_log" href="javascript:;"></a>
            </h2>
            <div class='pro_store_search'>
                <input type='text' value='' placeholder='输入门店信息'/>
                <a href="javascript:;" class='pro_icon'></a>
            </div>
            <div class='pro_ztree'>
                <ul id="pro_store_tree" class="ztree"></ul>
            </div>
            <div class='pro_sub'>
                <button>取消</button>
                <button>确认</button>
            </div>
        </div>
    </div>
</div>
<!-- dialog -->

<script type="text/javascript" src="js/jquery.ztree.all-3.5.min.js"></script>
<script>
    $('.new_sotre').on('click', function () {
        dialog(this);
    });
    var map1 = new BMap.Map("baiduMap");          // 创建地图实例
    var point1 = new BMap.Point(116.404, 39.915);  // 创建点坐标
    map1.centerAndZoom(point1, 15);                // 初始化地图，设置中心点坐标和地图级别
    var marker = new BMap.Marker(point1);// 创建标注
    map1.addOverlay(marker);             // 将标注添加到地图中
    marker.enableDragging()


    var map2 = new BMap.Map("baiduMap_info");          // 创建地图实例
    var point2 = new BMap.Point(116.331398, 39.897445);
    map2.centerAndZoom(point2, 12);

    var newPoint = '';
    $('.ssq select').eq(0).change(function () {
        newPoint = newPoint + $(".ssq select:nth-of-type(1) option:selected").html();
        map2.centerAndZoom(newPoint, 11);
    });
    $('.ssq select').eq(1).change(function () {
        newPoint = newPoint + $(".ssq select:nth-of-type(2) option:selected").html();
        map2.centerAndZoom(newPoint, 11);
    });
    $('.ssq select').eq(2).change(function () {
        newPoint = newPoint + $(".ssq select:nth-of-type(3) option:selected").html();
        map2.centerAndZoom(newPoint, 11);
    });

    $('.flex_title button').on('click',function(){
        dialog(this);
    });
    /*right_float*/
    var t = true;
    $('.flex_Click').click(function(){
        var w = $('.right_flex').width();
        if(w ==250&&t == true){
            console.log(t)
            $('.right_flex').css('width',w+'px');
            $(this).find('img').css('-webkit-transform','rotate(45deg)');
            t = false;
        }else{
            $('.right_flex').css('width','0px');
            $(this).find('img').css('-webkit-transform','rotate(0deg)');
            t = true;
        }
    });
    $('.right_flex').mouseenter(function(){
        if(t==true){
            $('.right_flex').css('width','250px');
        }
    });
    $('.right_flex').mouseleave(function(){
        if(t==true){
            $('.right_flex').css('width','0px');
        }
    });
    /*-------z-tree-------*/
    var setting = {
        edit: {
            enable: true,
            showRemoveBtn: false,
            showRenameBtn: false
        },
        data: {
            simpleData: {
                enable: true
            }
        }
    };

    var zNodes =[
        { id:1, pId:0, name:"随意拖拽 1", open:true},
        { id:11, pId:1, name:"随意拖拽 1-1"},
        { id:12, pId:1, name:"随意拖拽 1-2", open:true},
        { id:121, pId:12, name:"随意拖拽 1-2-1"},
        { id:122, pId:12, name:"随意拖拽 1-2-2"},
        { id:123, pId:12, name:"随意拖拽 1-2-3"},
        { id:13, pId:1, name:"禁止拖拽 1-3", open:true, drag:false},
        { id:131, pId:13, name:"禁止拖拽 1-3-1", drag:false},
        { id:132, pId:13, name:"禁止拖拽 1-3-2", drag:false},
        { id:133, pId:13, name:"随意拖拽 1-3-3"},
        { id:2, pId:0, name:"随意拖拽 2", open:true},
        { id:21, pId:2, name:"随意拖拽 2-1"},
        { id:22, pId:2, name:"禁止拖拽到我身上 2-2", open:true, drop:false},
        { id:221, pId:22, name:"随意拖拽 2-2-1"},
        { id:222, pId:22, name:"随意拖拽 2-2-2"},
        { id:223, pId:22, name:"随意拖拽 2-2-3"},
        { id:23, pId:2, name:"随意拖拽 2-3"}
    ];

    $(document).ready(function(){
        $.fn.zTree.init($("#treeDemo"), setting, zNodes);
    });

    $('.pro_store').click(function(){
        dialog(this);
    })

    /*-------z-tree-------*/
    var setting = {
        edit: {
            enable: true,
            showRemoveBtn: false,
            showRenameBtn: false
        },
        data: {
            simpleData: {
                enable: true
            }
        }
    };

    var zNodes =[
        { id:1, pId:0, name:"随意拖拽 1", open:true},
        { id:11, pId:1, name:"随意拖拽 1-1"},
        { id:12, pId:1, name:"随意拖拽 1-2", open:true},
        { id:121, pId:12, name:"随意拖拽 1-2-1"},
        { id:122, pId:12, name:"随意拖拽 1-2-2"},
        { id:123, pId:12, name:"随意拖拽 1-2-3"},
        { id:13, pId:1, name:"禁止拖拽 1-3", open:true, drag:false},
        { id:131, pId:13, name:"禁止拖拽 1-3-1", drag:false},
        { id:132, pId:13, name:"禁止拖拽 1-3-2", drag:false},
        { id:133, pId:13, name:"随意拖拽 1-3-3"},
        { id:2, pId:0, name:"随意拖拽 2", open:true},
        { id:21, pId:2, name:"随意拖拽 2-1"},
        { id:22, pId:2, name:"禁止拖拽到我身上 2-2", open:true, drop:false},
        { id:221, pId:22, name:"随意拖拽 2-2-1"},
        { id:222, pId:22, name:"随意拖拽 2-2-2"},
        { id:223, pId:22, name:"随意拖拽 2-2-3"},
        { id:23, pId:2, name:"随意拖拽 2-3"}
    ];

    function showIconForTree(treeId, treeNode) {
        return !treeNode.isParent;
    };

    $(document).ready(function(){
        $.fn.zTree.init($("#pro_store_tree"), setting, zNodes);
    });
    $('.pro_sub').on('click',function(){
        var check_value = $('.curSelectedNode .node_name').text();
        $('#pro_store').fadeOut();
        $('.pro_store').val(check_value);
        setTimeout(function () {
            $('#pro_store .fix').detach();
        }, 500)
    })
    $('.new_sotre').hover(
        function(){
            $(this).css('background-position','0px 1px')
        },
        function(){
            $(this).css('background-position','0px -24px')
        }
    )
</script>